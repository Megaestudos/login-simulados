<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Simulados de Concursos</title>

<style>
:root{
--primary:#2563eb;
--primary-dark:#1e40af;
--card:#ffffff;
--text:#0f172a;
--border:#e2e8f0;
}
*{box-sizing:border-box}
body{
margin:0;
font-family: Inter, system-ui, Arial, sans-serif;
min-height:100vh;
color:#fff;
background:
linear-gradient(rgba(15,23,42,.7), rgba(15,23,42,.7)),
url("https://images.pexels.com/photos/990432/pexels-photo-990432.jpeg");
background-size:cover;
background-position:center;
}
.page{
min-height:100vh;
display:flex;
align-items:center;
justify-content:center;
padding:24px;
}
.container{
width:100%;
max-width:980px;
display:grid;
grid-template-columns:1.2fr 1fr;
gap:40px;
}
@media(max-width:900px){ .container{grid-template-columns:1fr} }

.card{
background:#fff;
color:#0f172a;
border-radius:20px;
padding:32px;
box-shadow:0 40px 80px rgba(0,0,0,.35);
}
label{font-size:14px}
input{
width:100%;
padding:14px;
margin:6px 0 16px;
border-radius:12px;
border:1px solid var(--border);
font-size:15px;
}
button{
width:100%;
padding:14px;
border-radius:12px;
border:0;
font-size:15px;
cursor:pointer;
}
.btn-primary{background:var(--primary);color:#fff}
.btn-primary:hover{background:var(--primary-dark)}
.btn-sec{background:#f1f5f9;margin-top:10px}
.hide{display:none}

/* ===== MODAL ===== */
.modal-overlay{
position:fixed;
inset:0;
background:rgba(15,23,42,.75);
display:flex;
align-items:center;
justify-content:center;
z-index:9999;
}
.modal-box{
background:#fff;
color:#0f172a;
width:100%;
max-width:420px;
border-radius:20px;
padding:28px;
text-align:center;
box-shadow:0 40px 80px rgba(0,0,0,.4);
}
.modal-icon{font-size:40px;margin-bottom:10px}
.hide{display:none}
</style>
</head>

<!-- ===== MODAL ===== -->
<div id="modalOverlay" class="modal-overlay hide">
  <div class="modal-box">
    <div id="modalIcon" class="modal-icon">‚ÑπÔ∏è</div>
    <h3 id="modalTitle"></h3>
    <p id="modalMessage"></p>
    <button id="modalBtn" class="btn-primary">OK</button>
  </div>
</div>

<body>
<div class="page">
<div class="container">

<div>
<h1>Prepare-se para concursos</h1>
<p>Teste gr√°tis por 48h</p>
</div>

<div class="card">

<!-- LOGIN -->
<div id="loginBox">
<label>Email</label>
<input id="email" type="email" placeholder="seu@email.com">

<label>Senha</label>
<div style="position:relative">
  <input id="senha" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" style="padding-right:44px">
  <span id="toggleSenha" style="position:absolute;right:14px;top:50%;transform:translateY(-50%);cursor:pointer">üëÅÔ∏è</span>
</div>

<button class="btn-primary" id="btnEntrar">Entrar</button>
<button class="btn-sec" id="btnCriar">Criar conta gratuita</button>
<button class="btn-sec" id="btnResetSenha">Esqueci minha senha</button>
</div>

<!-- STATUS -->
<div id="statusBox" class="hide">
<p id="statusText" style="font-weight:900"></p>
<p id="statusSub"></p>

<button class="btn-primary" id="btnAcessarApp">Acessar o App</button>
<button class="btn-sec" id="btnSair">Sair</button>
</div>

</div>
</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
import {
  getAuth,
  setPersistence,
  browserSessionPersistence,
  signInWithEmailAndPassword,
  createUserWithEmailAndPassword,
  signOut,
  sendEmailVerification,
  sendPasswordResetEmail
} from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";
import { getFunctions, httpsCallable } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-functions.js";

/* ===== CONFIG ===== */
const FRONT_URL = "https://megaestudos.github.io/Quiz-Guarda-Civil-Premium/";
const firebaseConfig = {
  apiKey: "AIzaSyB36ZszS8v_DeOn3at7zEo_tFq86WU0sI4",
  authDomain: "simulados-concursos-22c91.firebaseapp.com",
  projectId: "simulados-concursos-22c91"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
await setPersistence(auth, browserSessionPersistence);

const fx = getFunctions(app, "us-central1");
const meCall = httpsCallable(fx, "me");

/* ===== HELPERS ===== */
const $ = id => document.getElementById(id);

function abrirModal(tipo, titulo, msg){
  const icons = { sucesso:"‚úÖ", erro:"‚ùå", aviso:"‚ö†Ô∏è", info:"‚ÑπÔ∏è" };
  $("modalIcon").innerText = icons[tipo] || "‚ÑπÔ∏è";
  $("modalTitle").innerText = titulo;
  $("modalMessage").innerText = msg;
  $("modalOverlay").classList.remove("hide");
}
$("modalBtn").onclick = ()=> $("modalOverlay").classList.add("hide");

/* ===== EVENTS ===== */
$("toggleSenha").onclick = ()=>{
  $("senha").type = $("senha").type === "password" ? "text" : "password";
};

$("btnEntrar").onclick = async ()=>{
  try{
    await signInWithEmailAndPassword(auth,$("email").value,$("senha").value);
    carregarStatus();
  }catch{
    abrirModal("erro","Erro","E-mail ou senha inv√°lidos");
  }
};

$("btnCriar").onclick = async ()=>{
  try{
    const user = (await createUserWithEmailAndPassword(auth,$("email").value,$("senha").value)).user;
    await sendEmailVerification(user);
    abrirModal("info","Verifique seu e-mail","Enviamos um link de confirma√ß√£o.");
  }catch{
    abrirModal("erro","Erro","N√£o foi poss√≠vel criar conta.");
  }
};

$("btnResetSenha").onclick = async ()=>{
  if(!$("email").value) return abrirModal("aviso","Informe o e-mail","Digite seu e-mail.");
  await sendPasswordResetEmail(auth,$("email").value);
  abrirModal("sucesso","E-mail enviado","Confira sua caixa de entrada.");
};

$("btnSair").onclick = async ()=>{
  await signOut(auth);
  $("statusBox").classList.add("hide");
  $("loginBox").classList.remove("hide");
};

$("btnAcessarApp").onclick = ()=> location.href = FRONT_URL;

/* ===== STATUS ===== */
async function carregarStatus(){
  const { data } = await meCall();
  $("loginBox").classList.add("hide");
  $("statusBox").classList.remove("hide");

  if(data.plan==="trial"){
    $("statusText").innerText = "Teste gr√°tis ativo";
    $("statusSub").innerText = "At√© " + new Date(data.expiresAt).toLocaleString();
  }else{
    $("statusText").innerText = "Acesso Premium";
    $("statusSub").innerText = "V√°lido at√© " + new Date(data.expiresAt).toLocaleString();
  }
}
</script>
</body>
</html>
