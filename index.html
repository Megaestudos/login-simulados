<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Simulados de Concursos</title>

<style>
:root{
  --primary:#2563eb;
  --primary-dark:#1e40af;
  --card:#ffffff;
  --text:#0f172a;
  --muted:#cbd5f5;
  --border:#e2e8f0;
  --success:#16a34a;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family: Inter, system-ui, -apple-system, Arial, sans-serif;
  min-height:100vh;
  color:#fff;
  background:
    linear-gradient(rgba(15,23,42,0.70), rgba(15,23,42,0.70)),
    url("https://images.pexels.com/photos/990432/pexels-photo-990432.jpeg");
  background-size:cover;
  background-position:center;
  background-attachment:fixed;
}
.page{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
}
.container{
  width:100%;
  max-width:980px;
  display:grid;
  grid-template-columns:1.2fr 1fr;
  gap:40px;
}
@media(max-width:900px){
  .container{grid-template-columns:1fr}
}
.hero h1{font-size:38px;margin:0 0 12px}
.hero p{font-size:18px;color:#e5e7eb}
.hero ul{list-style:none;padding:0}
.hero li{margin:10px 0}
.hero li::before{content:"✓ ";color:#22c55e}
.card{
  background:var(--card);
  color:var(--text);
  border-radius:20px;
  padding:32px;
  box-shadow:0 40px 80px rgba(0,0,0,.35);
}
label{font-size:14px;color:#475569}
input{
  width:100%;
  padding:14px;
  margin:6px 0 16px;
  border-radius:12px;
  border:1px solid var(--border);
  font-size:15px;
}
button{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:0;
  font-size:15px;
  cursor:pointer;
}
.btn-primary{background:var(--primary);color:#fff}
.btn-primary:hover{background:var(--primary-dark)}
.btn-sec{background:#f1f5f9;margin-top:10px}
.msg{
  margin-top:14px;
  font-size:14px;
  text-align:center;
  color:#dc2626;
}
</style>
</head>

<body>
<div class="page">
  <div class="container">

    <div class="hero">
      <h1>Prepare-se para concursos<br>com foco total em aprovação</h1>
      <p>Simulados atualizados, estudo direto ao ponto e acesso imediato.</p>
      <ul>
        <li>Questões comentadas</li>
        <li>Simulados realistas</li>
        <li>Conteúdo focado em prova</li>
        <li>Teste gratuito por 48 horas</li>
      </ul>
    </div>

    <div class="card">
      <h2>Acesso à plataforma</h2>
      <p style="color:#64748b">Crie sua conta ou entre para começar o teste.</p>

      <label>Email</label>
      <input id="email" type="email" placeholder="seu@email.com">

      <label>Senha</label>
      <input id="senha" type="password" placeholder="••••••••">

      <button class="btn-primary" onclick="entrar()">Entrar</button>
      <button class="btn-sec" onclick="criarConta()">Criar conta gratuita</button>

      <div id="msgLogin" class="msg"></div>
    </div>

  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
import {
  getAuth,
  onAuthStateChanged,
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  sendEmailVerification
} from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";
import {
  getFirestore,
  doc,
  getDoc,
  setDoc,
  serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

const FRONT_URL = "https://megaestudos.github.io/Quiz-Guarda-Civil-Premium/";
const HORAS_TRIAL = 48;

const firebaseConfig = {
  apiKey: "AIzaSyB36ZszS8v_DeOn3at7zEo_tFq86WU0sI4",
  authDomain: "simulados-concursos-22c91.firebaseapp.com",
  projectId: "simulados-concursos-22c91"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const $ = id => document.getElementById(id);

async function ensureUser(uid, email){
  const ref = doc(db, "users", uid);
  const snap = await getDoc(ref);
  if (!snap.exists()){
    await setDoc(ref, {
      email,
      criadoEm: serverTimestamp(),
      trialAte: new Date(Date.now() + HORAS_TRIAL * 3600000),
      pagoAte: null
    });
  }
}

window.criarConta = async () => {
  try{
    const cred = await createUserWithEmailAndPassword(
      auth, $("email").value, $("senha").value
    );
    await sendEmailVerification(cred.user);
    $("msgLogin").innerText = "Conta criada. Confirme seu e-mail.";
  }catch(e){
    $("msgLogin").innerText = e.message;
  }
};

window.entrar = async () => {
  try{
    await signInWithEmailAndPassword(
      auth, $("email").value, $("senha").value
    );
  }catch(e){
    $("msgLogin").innerText = e.message;
  }
};

window.continuar = () => {
  window.location.replace(FRONT_URL);
};

onAuthStateChanged(auth, async (user) => {
  if (!user) return;

  if (!user.emailVerified){
    $("msgLogin").innerText = "Confirme seu e-mail antes de continuar.";
    return;
  }

  await ensureUser(user.uid, user.email);

  $("msgLogin").innerHTML = `
    <span style="color:#16a34a">
      Sessão ativa detectada.<br>
      <button onclick="continuar()" style="
        margin-top:10px;
        padding:10px 16px;
        border-radius:10px;
        border:none;
        background:#16a34a;
        color:#fff;
        font-weight:600;
        cursor:pointer">
        Continuar para o simulado
      </button>
    </span>
  `;
});
</script>
</body>
</html>
